<?php
/**
 * Generated by Haxe 4.0.0-rc.3+e3df7a4
 */

namespace tink\core;

use \php\_Boot\HxAnon;
use \tink\core\_Lazy\LazyObject;
use \php\Boot;
use \haxe\ds\Option as DsOption;
use \php\_Boot\HxException;
use \tink\core\_Outcome\OutcomeMapper_Impl_;

class OutcomeTools {
	/**
	 *  Try to run `f` and wraps the result in `Success`,
	 *  thrown exceptions are transformed by `report` then wrapped into a `Failure`
	 * 
	 * @param \Closure $f
	 * @param \Closure $report
	 * 
	 * @return Outcome
	 */
	static public function attempt ($f, $report) {
		#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:138: lines 138-140
		try {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:138: characters 11-23
			return Outcome::Success($f());
		} catch (\Throwable $__hx__caught_e) {
			$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
			$e = $__hx__real_e;
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:140: characters 9-27
			return Outcome::Failure($report($e));
		}
	}

	/**
	 *   Returns `true` if the outcome is `Some` and the value is equal to `v`, otherwise `false`
	 * 
	 * @param Outcome $outcome
	 * @param mixed $to
	 * 
	 * @return bool
	 */
	static public function equals ($outcome, $to) {
		#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:84: lines 84-87
		$__hx__switch = ($outcome->index);
		if ($__hx__switch === 0) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:85: characters 29-39
			return Boot::equal($outcome->params[0], $to);
		} else if ($__hx__switch === 1) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:86: characters 26-31
			return false;
		}
	}

	/**
	 *  Transforms the outcome with a transform function
	 *  Different from `map`, the transform function of `flatMap` returns an `Outcome`
	 * 
	 * @param Outcome $o
	 * @param object $mapper
	 * 
	 * @return Outcome
	 */
	static public function flatMap ($o, $mapper) {
		#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:117: characters 5-27
		return OutcomeMapper_Impl_::apply($mapper, $o);
	}

	/**
	 * @param Outcome $o
	 * 
	 * @return Outcome
	 */
	static public function flatten ($o) {
		#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:143: lines 143-146
		$__hx__switch = ($o->index);
		if ($__hx__switch === 0) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:145: characters 20-30
			$_g = $o->params[0];
			$__hx__switch = ($_g->index);
			if ($__hx__switch === 0) {
				#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:144: characters 33-43
				return Outcome::Success($_g->params[0]);
			} else if ($__hx__switch === 1) {
				#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:145: characters 46-56
				return Outcome::Failure($_g->params[0]);
			}
		} else if ($__hx__switch === 1) {
			return Outcome::Failure($o->params[0]);
		}
	}

	/**
	 *  Returns `true` if the outcome is `Success`
	 * 
	 * @param Outcome $outcome
	 * 
	 * @return bool
	 */
	static public function isSuccess ($outcome) {
		#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:106: lines 106-109
		if ($outcome->index === 0) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:107: characters 26-30
			return true;
		} else {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:108: characters 18-23
			return false;
		}
	}

	/**
	 *  Transforms the outcome with a transform function
	 *  Different from `flatMap`, the transform function of `map` returns a plain value
	 * 
	 * @param Outcome $outcome
	 * @param \Closure $transform
	 * 
	 * @return Outcome
	 */
	static public function map ($outcome, $transform) {
		#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:94: lines 94-99
		$__hx__switch = ($outcome->index);
		if ($__hx__switch === 0) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:96: characters 11-32
			return Outcome::Success($transform($outcome->params[0]));
		} else if ($__hx__switch === 1) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:98: characters 11-21
			return Outcome::Failure($outcome->params[0]);
		}
	}

	/**
	 *  Extracts the value if the option is `Success`, otherwise `null`
	 * 
	 * @param Outcome $outcome
	 * 
	 * @return mixed
	 */
	static public function orNull ($outcome) {
		#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:55: lines 55-58
		$__hx__switch = ($outcome->index);
		if ($__hx__switch === 0) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:56: characters 29-33
			return $outcome->params[0];
		} else if ($__hx__switch === 1) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:57: characters 26-30
			return null;
		}
	}

	/**
	 *  Extracts the value if the option is `Success`, uses the fallback `Outcome` otherwise
	 * 
	 * @param Outcome $outcome
	 * @param LazyObject $fallback
	 * 
	 * @return Outcome
	 */
	static public function orTry ($outcome, $fallback) {
		#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:75: lines 75-78
		$__hx__switch = ($outcome->index);
		if ($__hx__switch === 0) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:76: characters 26-33
			return $outcome;
		} else if ($__hx__switch === 1) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:77: characters 26-40
			return $fallback->get();
		}
	}

	/**
	 *  Extracts the value if the option is `Success`, uses the fallback value otherwise
	 * 
	 * @param Outcome $outcome
	 * @param LazyObject $fallback
	 * 
	 * @return mixed
	 */
	static public function orUse ($outcome, $fallback) {
		#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:65: lines 65-68
		$__hx__switch = ($outcome->index);
		if ($__hx__switch === 0) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:66: characters 29-33
			return $outcome->params[0];
		} else if ($__hx__switch === 1) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:67: characters 26-40
			return $fallback->get();
		}
	}

	/**
	 *  Extracts the value if the outcome is `Success`, throws the `Failure` contents otherwise
	 * 
	 * @param Outcome $outcome
	 * 
	 * @return mixed
	 */
	static public function sure ($outcome) {
		#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:18: lines 18-26
		$__hx__switch = ($outcome->index);
		if ($__hx__switch === 0) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:20: characters 11-15
			return $outcome->params[0];
		} else if ($__hx__switch === 1) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:21: characters 22-29
			$_g1 = $outcome->params[0];
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:22: characters 18-40
			$_g = TypedError::asError($_g1);
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:23: lines 23-24
			if ($_g === null) {
				#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:23: characters 24-29
				throw new HxException($_g1);
			} else {
				#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:24: characters 21-34
				return $_g->throwSelf();
			}
		}
	}

	/**
	 *  Like `map` but with a plain value instead of a transform function, thus discarding the orginal result
	 * 
	 * @param Outcome $outcome
	 * @param mixed $v
	 * 
	 * @return Outcome
	 */
	static public function swap ($outcome, $v) {
		#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:125: lines 125-130
		$__hx__switch = ($outcome->index);
		if ($__hx__switch === 0) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:127: characters 11-21
			return Outcome::Success($v);
		} else if ($__hx__switch === 1) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:129: characters 11-21
			return Outcome::Failure($outcome->params[0]);
		}
	}

	/**
	 *  Creates an `Option` from this `Outcome`, discarding the `Failure` information
	 * 
	 * @param Outcome $outcome
	 * 
	 * @return DsOption
	 */
	static public function toOption ($outcome) {
		#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:33: lines 33-36
		$__hx__switch = ($outcome->index);
		if ($__hx__switch === 0) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:34: characters 29-46
			return DsOption::Some($outcome->params[0]);
		} else if ($__hx__switch === 1) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:35: characters 26-37
			return DsOption::None();
		}
	}

	/**
	 *  Creates an `Outcome` from an `Option`, with made-up `Failure` information
	 * 
	 * @param DsOption $option
	 * @param object $pos
	 * 
	 * @return Outcome
	 */
	static public function toOutcome ($option, $pos = null) {
		#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:43: lines 43-48
		$__hx__switch = ($option->index);
		if ($__hx__switch === 0) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:45: characters 11-25
			return Outcome::Success($option->params[0]);
		} else if ($__hx__switch === 1) {
			#/home/grabli66/haxelib/tink_core/git/src/tink/core/Outcome.hx:47: characters 11-124
			return Outcome::Failure(new TypedError(404, "Some value expected but none found in " . ($pos->fileName??'null') . "@line " . ($pos->lineNumber??'null'), new HxAnon([
				"fileName" => "tink/core/Outcome.hx",
				"lineNumber" => 47,
				"className" => "tink.core.OutcomeTools",
				"methodName" => "toOutcome",
			])));
		}
	}
}

Boot::registerClass(OutcomeTools::class, 'tink.core.OutcomeTools');
